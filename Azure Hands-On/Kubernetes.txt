Deploying a multi container application to Azure Kubernetes Services 

version=$(az aks get-versions -l westus --query 'orchestrators[-1].orchestratorVersion' -o tsv) 

az group create --name akshandsonlab --location westus 

az aks create --resource-group akshandsonlab --name aksatin6122021 --enable-addons monitoring --kubernetes-version $version --generate-ssh-keys --location westus 

az acr create --resource-group akshandsonlab --name aksatin6122021 --sku Standard --location westus 

export AKS_RESOURCE_GROUP=akshandsonlab 

export ACR_RESOURCE_GROUP=akshandsonlab 

export AKS_CLUSTER_NAME=aksatin6122021 

export ACR_NAME=aksatin6122021 

 # Get the id of the service principal configured for AKS 

CLIENT_ID=$(az aks show --resource-group $AKS_RESOURCE_GROUP --name $AKS_CLUSTER_NAME --query "servicePrincipalProfile.clientId" --output tsv) 

 # Get the ACR registry resource id 

ACR_ID=$(az acr show --name $ACR_NAME --resource-group $ACR_RESOURCE_GROUP --query "id" --output tsv) 

 # Create role assignment 

az role assignment create --assignee $CLIENT_ID --role acrpull --scope $ACR_ID 

az sql server create -l westus -g akshandsonlab -n atinsqlserver6122021 -u sqladmin -p P2ssw0rd1234 

az sql db create -g akshandsonlab -s atinsqlserver6122021  -n mhcdb --service-objective S0 

 

Note Details: 

ACR: aksatin6122021.azurecr.io

SQLpassword:P2ssw0rd1234

SQLserver: atinsqlserver6122021.database.windows.net

SQLuser:sqladmin

DatabaseName: mhcdb


 

 

az aks get-credentials --resource-group akshandsonlab --name aksatin6122021 

kubectl get pods 

kubectl get service mhc-front --watch 

 